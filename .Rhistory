gap = 3, ylab=c('Missin Data', 'Pattern')
)
imputed_data <- mice(iris.mis, m=5,maxit=50, method='pmm',seed = 500)
package_version(R.version)
R.version
# VIM missig data matrix
aggr(iris.mis, col=c('navyblue','yellow'),
numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.7,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
imputed_data <- mice(iris.mis, m=5,maxit=50, method='pmm',seed = 500)
install.packages("installr")
library(installr)
check.for.updates.R()
install.R()
version()
check.for.updates.R()
check.for.updates.R()
library(installr)
check.for.updates.R()
check.for.updates.R()
version
install.packages(c("mice", "missForest", "VIM"))
library(missForest)
library(mice)
library(VIM)
# VIM missig data matrix
aggr(iris.mis, col=c('navyblue','yellow'),
numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.7,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
summary(iris)
str(iris)
# Generate Missing Values
install.packages('missForest')
# Check NAs
summary(iris.mis)
iris.mis <- prodNA(iris, noNA=0.1)
# Check NAs
summary(iris.mis)
# iris.mis delete categorical varable(Species)
head(subset(iris.mis, select=-c(Species)))
iris.mis <- subset(iris.mis, select = -c(Species))
# VIM missig data matrix
aggr(iris.mis, col=c('navyblue','yellow'),
numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.7,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
imputed_data <- mice(iris.mis, m=5,maxit=50, method='pmm',seed = 500)
summary(imputed_data)
md.pattern(iris.mis)
install.packages('gridExtra')
install.packages('corrplot')
install.packages(c("corrplot", "dplyr", "ggplot2", "gridExtra", "VIM"))
install.packages(c("corrplot", "dplyr", "ggplot2", "gridExtra", "VIM"))
library(dplyr)
library(ggplot2)
library(VIM) # Visualzation and imputation of Missing Values
library(corrplot) # corrplot
### Variable Definition
# survival	Survival	0 = No, 1 = Yes
# pclass	Ticket class	1 = 1st, 2 = 2nd, 3 = 3rd
# sex	Sex
# Age	Age in years
# sibsp	# of siblings / spouses aboard the Titanic
# parch	# of parents / children aboard the Titanic
# ticket	Ticket number
# fare	Passenger fare
# cabin	Cabin number
# embarked	Port of Embarkation
#### Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
#### Data Check
str(all)
dim(all)
summary(all)
glimpse(all)
#### Change int to Factor
# Survived, Pclass, Sex, Embarked는 Factor의 요소라고 볼 수 있음
all <- all %>% mutate(Survived = factor(Survived),
Pclass = factor(Pclass),
Sex = factor(Sex),
Embarked = factor(Embarked))
#### Check Missing Value
library(VIM) # Visualzation and imputation of Missing Values
library(gridExtra)
# Cabin Data Missing Processing
# Cabin 변수를 보면 분명 공란이 많은데 NA로 인식하지 않는다.
table(is.na(all$Cabin))
# 따라서 해당 변수에서 len이 0이하이면 NA로 바꿔주는 작업을하려고 한다.
# ** length는 데이터 Set의 길이를 반환한다.
# ** nchar는 데이터 각 Row의 길이를 반환한다.
all$Cabin <- ifelse(nchar(all$Cabin)>0,all$Cabin,NA)
head(all)
data <- iris
summary(iris)
str(iris)
# Generate Missing Values
install.packages('missForest')
library(missForest)
iris.mis <- prodNA(iris, noNA=0.1)
# Check NAs
summary(iris.mis)
# iris.mis delete categorical varable(Species)
head(subset(iris.mis, select=-c(Species)))
iris.mis <- subset(iris.mis, select = -c(Species))
# install MICE
install.packages('mice')
library(mice)
library(VIM)
# missing data matrix
md.pattern(iris.mis)
# VIM missig data matrix - better version of md.pattern
aggr(iris.mis, col=c('navyblue','yellow'),
numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.7,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
imputed_data <- mice(iris.mis, m=5, maxit=50, method='pmm', seed = 500)
summary(imputed_data)
imputed_data
imputed_data$imp
imputed_data$imp$Sepal.Width
View(imputed_data)
# Get complete data
completeData <- complete(imputed_data,2)
completeData
View(imputed_data)
imputed_data[["data"]][["Sepal.Length"]]
View(imputed_data[["imp"]][["Sepal.Length"]])
imputed_data[["imp"]][["Sepal.Length"]]
imputed_data[["data"]][["Sepal.Width"]]
imputed_data[["imp"]][["Petal.Length"]]
complete(imputed_data,5)
# Build Predictive model
fit <- with(data = iris.mis, exp = lm(Sepal.Width ~ Sepal.Length + Petal.Width))
fit
# combine results of 5 models
combine <- pool(fit)
summary(combine)
# combine results of 5 models
combine <- pool(fit)
data <- iris
summary(iris)
str(iris)
sample(1:10,5,replace = T)
sample(1:10,5,replace = F)
# VIM missig data matrix - better version of md.pattern
aggr(iris.mis, col=c('navyblue','yellow'),
numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.7,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
# VIM missig data matrix - better version of md.pattern
aggr(iris.mis, col=c('navyblue','yellow'),
numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.6,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
# VIM missig data matrix - better version of md.pattern
aggr(iris.mis, col=c('navyblue','yellow'),
props=F, numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.6,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
# VIM missig data matrix - better version of md.pattern
aggr(iris.mis, col=c('navyblue','yellow'),
prop=F, numbers = T, sortVars = T,
labels=names(iris.mis), cex.axis=.6,
gap = 3, ylab=c('Missin Data', 'Pattern')
)
# Check NAs
summary(iris.mis)
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 2. Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
#### 3. Data Check
str(all)
dim(all)
summary(all)
glimpse(all)
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
library(dplyr)
library(ggplot2)
library(VIM) # Visualzation and imputation of Missing Values
library(corrplot) # corrplot
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
data[-c(62,830),] %>% ggplot(mapping= aes(Embarked, count(Embarked)))+
geom_boxplot()
data[-c(62,830),] %>% ggplot(mapping= aes(Embarked, count(all$Embarked)))+
geom_boxplot()
data[-c(62,830),] %>% ggplot(mapping= aes('Embarked', count(all$Embarked)))+
geom_boxplot()
data[-c(62,830),] %>% ggplot(mapping= aes('Embarked', count(all$'Embarked')))+
geom_boxplot()
data[-c(62,830),] %>% ggplot(mapping= aes('Embarked',Fare))+
geom_boxplot()
all[-c(62,830),] %>% ggplot(mapping= aes('Embarked',count(Embarked)))+
geom_boxplot()
all[-c(62,830),] %>% ggplot(mapping= aes(Embarked,count(Embarked)))+
geom_boxplot()
all[-c(62,830),] %>% ggplot(mapping= aes(Embarked,nrow(all)))+
geom_boxplot()
all[-c(62,830),] %>%
group_by(Embarked) %>%
summarise(n = n())
all[-c(62,830),] %>%
group_by(Embarked) %>%
summarise(n = n()) %>%
ggplot(mapping= aes(Embarked,))+
geom_boxplot()
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()
all[nchar(all$Embarked) <1, "Embarked"] #62, 830 Data Missing
all[nchar(all$Embarked) <1, "Embarked"] <- NA#62, 830 Data Missing
all[nchar(all$Embarked) <1, "Embarked"] #62, 830 Data Missing
all[nchar(all$Embarked) <1] #62, 830 Data Missing
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
#### 2. Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[nchar(all$Embarked) <1,]$Embarked  # <- NA # NA 처리해주기
all[nchar(all$Embarked) <1,]$Embarked   <- NA # NA 처리해주기
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 2. Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
all[c(62,830),]
all[c(62,830),]$Embarked
# b-2. Embarked와 Fare 간의 관계
ggplot(data = all, mapping = aes(Embarked, Fare))+
geom_boxplot()
library(dplyr)
library(ggplot2)
library(VIM) # Visualzation and imputation of Missing Values
library(corrplot) # corrplot
# b-2. Embarked와 Fare 간의 관계
ggplot(data = all, mapping = aes(Embarked, Fare))+
geom_boxplot()
# b-2. Embarked와 Fare 간의 관계
ggplot(data = all, mapping = aes(Embarked, Fare))+
geom_boxplot()
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
# Check Cabin Data Missing Processing
# ** Cabin 변수를 보면 분명 공란이 많은데 NA로 인식하지 않는다.
table(is.na(all$Cabin))
library(dplyr)
library(ggplot2)
library(VIM) # Visualzation and imputation of Missing Values
library(corrplot) # corrplot
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 2. Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
dim(all)
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[nchar(all$Embarked) <1,]$Embarked <- NA # NA 처리해주기
all[c(62,830),]$Embarked
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 2. Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
#### 3. Data Check
str(all)
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[c(62,830),]$Embarked
all[c(62,830),]$Embarked <- NA
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 2. Count Survival
train %>% count(Survived)
surv <- train %>% count(Survived) %>% filter(Survived == 1) %>% .$n
nosurv <- train %>% count(Survived) %>% filter(Survived == 0) %>% .$n
all[c(62,830),]$Embarked
all[c(62,830),Embarked]$Embarked[]
all[c(62,830),'Embarked']$Embarked[]
all[c(62,830),'Embarked']
all[c(62,830),'Embarked'] <- NA
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[c(62,830),'Embarked'][is.na(all[c(62,830),'Embarked'])]
all[c(62,830),'Embarked'][is.na(all[c(62,830),'Embarked'])]
is_empty
all[c(62,830),'Embarked'] = NA
all[c(62,830),'Embarked'] == NA
all[c(62,830),] == NA
all[c(62,830),]
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
library(dplyr)
library(ggplot2)
library(VIM) # Visualzation and imputation of Missing Values
library(corrplot) # corrplot
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
# a) Check Embarked
table(is.na(all$Embarked))
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[c(62,830),]
all[c(62,830),]
all[c(62,830),Embarked]
all[c(62,830),'Embarked']
all[,'Embarked']
all[all$Embarked =='','Embarked']
all[all$Embarked =='','Embarked'] <- ＮＡ
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
# Check Cabin Data Missing Processing
# ** Cabin 변수를 보면 분명 공란이 많은데 NA로 인식하지 않는다.
table(is.na(all$Cabin))
all[all$Embarked =='','Embarked'] <- NA
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
test <- read.csv('data/test.csv')
#### 1. Data Load
train <- read.csv('data/train.csv')
test <- read.csv('data/test.csv')
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
all[all$Embarked =='','Embarked'] %>% replace(.=='',NA)
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[all$Embarked =='','Embarked'] %>% replace(.=='',NA)
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all[all$Embarked =='','Embarked'] <- all[all$Embarked =='','Embarked'] %>% replace(.=='',NA)
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 1. Data Load
train <- read.csv('data/train.csv', na.strings = c('','NA'))
test <- read.csv('data/test.csv', na.strings = c('','NA'))
all_Origin <- all
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
#### 3. Data Check
str(all)
summary(all)
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
#### 1. Data Load
train <- read.csv('data/train.csv', na.strings = c('','NA'))
test <- read.csv('data/test.csv', na.strings = c('','NA'))
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
all[nchar(all$Embarked) <1, ] #62, 830 Data Missing
# all[nchar(all$Embarked) <1,]$Embarked <- NA # NA 처리해주기
# all[c(62,830),]$Embarked <- NA
# ** 위의 두 방법은 아예 하나의 Row를 NA로 처리해버림
all[is.na(all$Embarked),]
#### 1. Data Load
train <- read.csv('data/train.csv', na.strings = c('','NA'))
test <- read.csv('data/test.csv', na.strings = c('','NA'))
all <- bind_rows(train,test) # 두개의 데이터를 합친다.
all_Origin <- all
# all[nchar(all$Embarked) <1,]$Embarked <- NA # NA 처리해주기
# all[c(62,830),]$Embarked <- NA
# ** 위의 두 방법은 아예 하나의 Row를 NA로 처리해버림
all[is.na(all$Embarked),]
# all[nchar(all$Embarked) <1,]$Embarked <- NA # NA 처리해주기
all[c(62,830),]$Embarked <- NA
# ** 위의 두 방법은 아예 하나의 Row를 NA로 처리해버림
all[is.na(all$Embarked),]
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = sum(all$Fare)/nrow(all))
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = sum(all$Fare, na.rm=T)/nrow(all))
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = sum(all$Fare, na.rm=T)/nrow(all), lty =2, col ='red')
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = sum(all$Fare, na.rm=T)/nrow(all), lty =2, col ='red',show.legend = T)
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = sum(all$Fare, na.rm=T)/nrow(all), lty =2, col ='red',show.legend = T)
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = sum(all[all$Embarked=='Q',]$Fare, na.rm=T)/nrow(all), lty =2, col ='red',show.legend = T)
# Data NA 변환 확인
all[is.na(all$Embarked),]
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = c(sum(all[all$Embarked=='Q',]$Fare, na.rm=T)/nrow(all),sum(all$Fare, na.rm=T)/nrow(all))
, lty =2, col =('red','blue'), show.legend = T)
#
all[-c(62,830),] %>%
ggplot(mapping= aes(Embarked,Fare))+
geom_boxplot()+
geom_hline(yintercept = c(sum(all[all$Embarked=='Q',]$Fare, na.rm=T)/nrow(all[all$Embarked =='Q', ]), sum(all$Fare, na.rm=T)/nrow(all))
, lty =2, col ='red', show.legend = T)
install.packages('RColorBrewer')
library(RColorBrewer)
# Data NA 변환 확인
all[is.na(all$Embarked),]
all[-c(62,830),]$Embarked
all[-c(62,830),]
all[-c(62,830),] %>% group_by(Embarked) %>%
summarise(mean_Fare = mean(Fare, na.rm =T))
all[-c(62,830),] %>% group_by(Embarked, Pclass) %>%
summarise(mean_Fare = mean(Fare, na.rm =T))
# Data NA 변환 확인
all[is.na(all$Embarked),]
all[-c(62,830),] %>%
filter(Pclass = 1) %>%
group_by(Embarked) %>%
summarise(mean_Fare = mean(Fare, na.rm =T))
all[-c(62,830),] %>%
filter(Pclass == 1) %>%
group_by(Embarked) %>%
summarise(mean_Fare = mean(Fare, na.rm =T))
all[-c(62,830),] %>%
filter(Pclass == 1) %>%
group_by(Embarked) %>%
summarise(mean_Fare = mean(Fare, na.rm =T),
n = n())
